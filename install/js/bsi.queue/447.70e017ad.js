/*! For license information please see 447.70e017ad.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[447],{6099:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>X});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-dashboard"},[e("div",{staticClass:"c-dashboard__panel"},[e("app-time-picker",{on:{change:t.handleTimePresetChange},model:{value:t.timePreset,callback:function(e){t.timePreset=e},expression:"timePreset"}}),t._v(" "),e("app-refresh-picker",{attrs:{title:t.$t("tooltip.autoUpdate")},model:{value:t.refresh,callback:function(e){t.refresh=e},expression:"refresh"}})],1),t._v(" "),e("el-row",{attrs:{type:"flex",gutter:20}},[e("el-col",{attrs:{span:4}},[e("dashboard-panel",{attrs:{title:t.$t("title.status")}},[t.init?e("stat-panel",{attrs:{type:t.hasConsumers?"success":"danger",title:t.hasConsumers?"":t.$t("tooltip.notFoundConsumers")}},[t._v("\n                    "+t._s(t.hasConsumers?t.$t("label.ok"):t.$t("label.problem"))+"\n                ")]):e("stat-panel",[t._v("\n                    -\n                ")])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("dashboard-panel",{attrs:{title:t.$t("title.consumers")}},[e("stat-panel",[t._v("\n                    "+t._s(t.summary.consumers?t.summary.consumers.toLocaleString():0)+"\n                ")])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("dashboard-panel",{attrs:{title:t.$t("enums.status.sent")}},[e("stat-panel",{attrs:{type:"info"}},[t._v("\n                    "+t._s(t.summary.sent?t.summary.sent.toLocaleString():0)+"\n                ")])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("dashboard-panel",{attrs:{title:t.$t("enums.status.received")}},[e("stat-panel",{attrs:{type:"warning"}},[t._v("\n                    "+t._s(t.summary.received?t.summary.received.toLocaleString():0)+"\n                ")])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("dashboard-panel",{attrs:{title:t.$t("enums.status.handled")}},[e("stat-panel",{attrs:{type:"success"}},[t._v("\n                    "+t._s(t.summary.handled?t.summary.handled.toLocaleString():0)+"\n                ")])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("dashboard-panel",{attrs:{title:t.$t("enums.status.failed")}},[e("stat-panel",{attrs:{type:"danger"}},[t._v("\n                    "+t._s(t.summary.failed?t.summary.failed.toLocaleString():0)+"\n                ")])],1)],1)],1),t._v(" "),e("el-row",{attrs:{type:"flex"}},[e("el-col",{attrs:{span:24}},[e("dashboard-panel",{attrs:{title:t.$t("title.stats")}},[e("chart-panel",{attrs:{series:t.chartSeries,options:t.chartOptions,height:"300px"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{type:"flex"}},[e("el-col",{attrs:{span:24}},[e("dashboard-panel",{attrs:{title:t.$t("title.messages")}},[e("recent-messages-panel",{attrs:{data:t.recentMessages.data,total:t.recentMessages.total,"page-size":t.recentMessages.pageSize},on:{"message-select":t.handleMessageSelect,paginate:t.handleRecentMessagesPaginate,"page-size-change":t.handleRecentMessagesPageSizeChange,search:t.handleRecentMessagesSearch}})],1)],1)],1),t._v(" "),t.drawerMessage?e("el-drawer",{attrs:{title:t.drawerMessage.message,visible:t.drawer,"destroy-on-close":"",size:"70%","custom-class":"c-drawer"},on:{"update:visible":function(e){t.drawer=e},closed:t.handleDrawerClosed}},[e("message-details",{attrs:{data:t.drawerMessage}})],1):t._e()],1)};a._withStripped=!0;r(9653),r(6992),r(1539),r(8674),r(8783),r(3948),r(1249),r(4916),r(4765),r(2564),r(9070),r(2526),r(1817),r(2165),r(2443),r(3680),r(3706),r(2703),r(8011),r(489),r(9554),r(4747),r(8309),r(8304),r(5069),r(7042);const n={props:{initial:{type:Object,default:function(){return{}}}}};var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-time-picker"},[e("el-dropdown",{on:{command:t.handleCommand}},[e("el-button",{attrs:{type:"default"}},[e("i",{staticClass:"el-icon-time el-icon--left"}),t._v(t._s(t.currentPreset.name)),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.enabledPresets,(function(r){return e("el-dropdown-item",{key:r.id,attrs:{command:r.id}},[t._v("\n                "+t._s(r.name)+"\n                "),r.id===t.value?e("i",{staticClass:"el-icon-check el-icon--right"}):t._e()])})),1)],1)],1)};s._withStripped=!0;r(9826);const i={props:{value:{type:String,required:!0},presets:{type:Array,default:function(){return[]}}},data:function(){return{allPresets:[{id:"-5 minutes",name:this.$t("enums.datePreset.last5m")},{id:"-15 minutes",name:this.$t("enums.datePreset.last15m")},{id:"-30 minutes",name:this.$t("enums.datePreset.last30m")},{id:"-1 hours",name:this.$t("enums.datePreset.last1h")},{id:"-3 hours",name:this.$t("enums.datePreset.last3h")},{id:"-6 hours",name:this.$t("enums.datePreset.last6h")},{id:"-12 hours",name:this.$t("enums.datePreset.last12h")},{id:"-24 hours",name:this.$t("enums.datePreset.last24h")},{id:"-2 days",name:this.$t("enums.datePreset.last2d")},{id:"-7 days",name:this.$t("enums.datePreset.last7d")},{id:"-30 days",name:this.$t("enums.datePreset.last30d")},{id:"-60 days",name:this.$t("enums.datePreset.last60d")},{id:"-90 days",name:this.$t("enums.datePreset.last90d")},{id:"-6 months",name:this.$t("enums.datePreset.last6M")},{id:"-1 year",name:this.$t("enums.datePreset.last1y")}]}},computed:{currentPreset:function(){var t=this;return this.allPresets.find((function(e){return e.id===t.value}))},enabledPresets:function(){var t=this;return 0===this.presets.length?this.allPresets:this.presets.map((function(e){return t.allPresets.find((function(t){return t.id===e}))}))}},methods:{handleCommand:function(t){this.$emit("input",t),this.$emit("change",t)}}};var o=r(1900);const l=(0,o.Z)(i,s,[],!1,null,null,null).exports;var c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-refresh-picker"},[e("el-button",{attrs:{type:t.value?"primary":"default"},on:{click:t.handleClick}},[e("i",{staticClass:"el-icon-refresh"})])],1)};c._withStripped=!0;const u={props:{value:{type:Boolean,required:!0}},methods:{handleClick:function(){this.$emit("input",!this.value)}}};const h=(0,o.Z)(u,c,[],!1,null,null,null).exports;var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-dashboard-panel"},[e("div",{staticClass:"c-dashboard-panel__header"},[e("div",{staticClass:"c-dashboard-panel__title"},[t._v("\n            "+t._s(t.title)+"\n        ")])]),t._v(" "),e("div",{staticClass:"c-dashboard-panel__content"},[t._t("default",(function(){return[t._m(0)]}))],2)])};d._withStripped=!0;const p={props:{title:{type:String,default:""}}};const f=(0,o.Z)(p,d,[function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-dashboard-panel__stub"},[e("i",{staticClass:"el-icon-s-data"}),t._v(" "),e("div",[t._v("Нет данных")])])}],!1,null,null,null).exports;var m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-stat-panel",class:t.type?"c-stat-panel--".concat(t.type):""},[e("div",{staticClass:"c-stat-panel__value"},[t._t("default")],2)])};m._withStripped=!0;const v={props:{type:{type:String,default:""}}};const y=(0,o.Z)(v,m,[],!1,null,null,null).exports;var g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-chart-panel"},[e("apexchart",{attrs:{type:"area",options:t.mergedOptions,series:t.series,width:"98%",height:t.height}})],1)};g._withStripped=!0;r(9753),r(9601),r(7941),r(6649),r(6078);var _=r(7166),b=r.n(_),w=r(1027);function S(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==P(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!==P(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===P(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}const x={components:{apexchart:b()},props:{series:{type:Array,required:!0},options:{type:Object,required:!1,default:function(){return{}}},height:{type:String,default:"auto"}},data:function(){return{defaultOptions:{chart:{locales:[w],defaultLocale:"ru",toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},tooltip:{shared:!0,x:{format:"dd.MM.yyyy HH:mm:ss"}},stroke:{curve:"straight",width:2},fill:{type:"solid",opacity:.4},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},yaxis:{decimalsInFloat:!1}}}},computed:{mergedOptions:function(){return this.extend(this.defaultOptions,this.options)}},methods:{isObject:function(t){return t&&"object"===P(t)&&!Array.isArray(t)},extend:function(t,e){var r=this,a=Object.assign({},t);return this.isObject(t)&&this.isObject(e)&&Object.keys(e).forEach((function(n){r.isObject(e[n])&&n in t?a[n]=r.extend(t[n],e[n]):Object.assign(a,S({},n,e[n]))})),a}}};const C=(0,o.Z)(x,g,[],!1,null,null,null).exports;r(9600);var $=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-table-panel"},[e("div",{staticClass:"c-table-panel__search"},[e("el-input",{attrs:{placeholder:t.$t("label.findMessages")},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),e("table",{staticClass:"c-table"},[e("thead",[e("tr",[e("th",{staticStyle:{width:"140px"}},[t._v("\n                    "+t._s(t.$t("label.sent_at"))+"\n                ")]),t._v(" "),e("th",[t._v("\n                    "+t._s(t.$t("label.message"))+"\n                ")]),t._v(" "),e("th",{staticStyle:{width:"140px"}},[t._v("\n                    "+t._s(t.$t("label.status"))+"\n                ")]),t._v(" "),e("th",{staticStyle:{width:"200px"}},[t._v("\n                    "+t._s(t.$t("label.transport_name"))+"\n                ")]),t._v(" "),e("th",[t._v("\n                    "+t._s(t.$t("label.buses"))+"\n                ")])])]),t._v(" "),e("tbody",[t._l(t.data,(function(r,a){return e("tr",{key:a},[e("td",[t._v("\n                    "+t._s(t.formatDate(r.sent_at))+"\n                ")]),t._v(" "),e("td",[e("a",{staticClass:"c-link",on:{click:function(e){return e.preventDefault(),t.handleMessageSelect(r)}}},[t._v("\n                        "+t._s(r.message)+"\n                    ")])]),t._v(" "),e("td",[e("el-tag",{attrs:{type:t.getStatusType(r.status),"disable-transitions":""}},[t._v("\n                        "+t._s(t.$t("enums.status.".concat(r.status)))+"\n                    ")])],1),t._v(" "),e("td",[t._v("\n                    "+t._s(r.transport_name)+"\n                ")]),t._v(" "),e("td",[t._v("\n                    "+t._s(Array.isArray(r.buses)?r.buses.join(", "):"")+"\n                ")])])})),t._v(" "),0===t.data.length?e("tr",[e("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"5"}},[t._v("\n                    Нет данных\n                ")])]):t._e()],2)]),t._v(" "),e("el-pagination",{attrs:{background:"",layout:"prev, pager, next, sizes",total:t.total,"page-size":t.currentPageSize,"page-sizes":t.pageSizes},on:{"update:pageSize":function(e){t.currentPageSize=e},"update:page-size":function(e){t.currentPageSize=e},"current-change":t.handlePageChange,"size-change":t.handlePageSizeChange}})],1)};$._withStripped=!0;r(3710);const M={props:{data:{type:Array,required:!0},total:{type:Number,required:!0},pageSize:{type:Number,default:10},pageSizes:{type:Array,default:function(){return[10,20,50]}},searchDelay:{type:Number,default:300}},data:function(){return{search:"",searchTimeout:null}},computed:{currentPageSize:{get:function(){return this.pageSize},set:function(t){this.$emit("update:pageSize",t)}}},watch:{search:function(t){var e=this;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){e.$emit("search",t)}),this.searchDelay)}},methods:{getStatusType:function(t){return"failed"===t?"danger":"received"===t?"warning":"handled"===t?"success":"info"},formatDate:function(t){return new Date(t).toLocaleString()},handleMessageSelect:function(t){this.$emit("message-select",t)},handlePageChange:function(t){this.$emit("paginate",t)},handlePageSizeChange:function(t){this.$emit("page-size-change",t)}}};const k=(0,o.Z)(M,$,[],!1,null,null,null).exports;var j=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-message-details c-dashboard"},[e("el-row",{attrs:{type:"flex",gutter:20}},[e("el-col",{attrs:{span:12}},[e("dashboard-panel",{attrs:{title:t.$t("title.summary")}},[e("div",{staticClass:"c-message-details__summary"},t._l(t.summaryProps,(function(r,a){return e("el-row",{key:a,attrs:{type:"flex",gutter:20}},[e("el-col",{attrs:{span:8}},[t._v("\n                            "+t._s(r.name)+"\n                        ")]),t._v(" "),e("el-col",{attrs:{span:16}},[t._v("\n                            "+t._s(r.value)+"\n                        ")])],1)})),1)])],1),t._v(" "),e("el-col",{attrs:{span:12}},[e("dashboard-panel",{attrs:{title:t.$t("title.data")}},[e("div",{staticClass:"c-message-details__data"},[e("vue-json-pretty",{attrs:{data:t.prettyData}})],1)])],1)],1),t._v(" "),t.data.error?e("el-row",{attrs:{type:"flex"}},[e("el-col",{attrs:{span:24}},[e("dashboard-panel",{attrs:{title:t.$t("title.errors")}},[e("table",{staticClass:"c-table c-table--striped"},[e("tbody",t._l(t.errorRows,(function(r,a){return e("tr",{key:a},[e("td",[t._v("\n                                "+t._s(r)+"\n                            ")])])})),0)])])],1)],1):t._e()],1)};j._withStripped=!0;r(7327),r(3123);var L=r(4566),D=r.n(L),O=r(4539),E=r.n(O);const z={components:{VueJsonPretty:D(),DashboardPanel:f},props:{data:{type:Object,required:!0}},computed:{summaryProps:function(){return[{name:this.$t("label.uuid"),value:this.data.uuid},{name:this.$t("label.transport_name"),value:this.data.transport_name},{name:this.$t("label.buses"),value:Array.isArray(this.data.buses)?this.data.buses.join(", "):null},{name:this.$t("label.sent_at"),value:this.formatDate(this.data.sent_at)},{name:this.$t("label.received_at"),value:this.data.received_at?this.formatDate(this.data.received_at):null},{name:this.$t("label.handled_at"),value:this.data.handled_at?this.formatDate(this.data.handled_at):null},{name:this.$t("label.failed_at"),value:this.data.failed_at?this.formatDate(this.data.failed_at):null}].filter((function(t){return null!==t.value&&void 0!==t.value&&""!==t.value}))},prettyData:function(){return E()(this.data.data)},errorRows:function(){return this.data.error.split(/\r?\n/)}},methods:{formatDate:function(t){return new Date(t).toLocaleString()}}};const T=(0,o.Z)(z,j,[],!1,null,null,null).exports;var A=r(9669),q=r.n(A),R=r(129),N=r.n(R),I=r(2640),F=r.n(I);function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}var Z=q().create({timeout:3e4});Z.interceptors.request.use((function(t){return t.headers["X-Bitrix-Csrf-Token"]=F().bitrix_sessid(),t}),(function(t){return console.error(t),Promise.reject(t)})),Z.interceptors.response.use((function(t){var e=t.data;return"object"===G(e)&&"error"===e.status?Array.isArray(e.errors)&&e.errors.length>0?Promise.reject(new Error(e.errors.map((function(t){return t.message})).join("\n"))):Promise.reject(new Error("Error")):e.data}),(function(t){return console.error(t),Promise.reject(t)}));var U=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof t||0===t.length)throw new TypeError('Invalid argument "endpoint"');return Z({url:"/bitrix/services/main/ajax.php",method:"post",params:{action:t},data:N().stringify(e,{arrayFormat:"indices"})})};function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function H(){H=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(t,e,r,a){var s=e&&e.prototype instanceof y?e:y,i=Object.create(s.prototype),o=new L(a||[]);return n(i,"_invoke",{value:$(t,r,o)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",p="suspendedYield",f="executing",m="completed",v={};function y(){}function g(){}function _(){}var b={};c(b,i,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(D([])));S&&S!==r&&a.call(S,i)&&(b=S);var P=_.prototype=y.prototype=Object.create(b);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(n,s,i,o){var l=h(t[n],t,s);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==B(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,i,o)}),(function(t){r("throw",t,i,o)})):e.resolve(u).then((function(t){c.value=t,i(c)}),(function(t){return r("throw",t,i,o)}))}o(l.arg)}var s;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return s=s?s.then(n,n):n()}})}function $(e,r,a){var n=d;return function(s,i){if(n===f)throw new Error("Generator is already running");if(n===m){if("throw"===s)throw i;return{value:t,done:!0}}for(a.method=s,a.arg=i;;){var o=a.delegate;if(o){var l=M(o,a);if(l){if(l===v)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===d)throw n=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=f;var c=h(e,r,a);if("normal"===c.type){if(n=a.done?m:p,c.arg===v)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(n=m,a.method="throw",a.arg=c.arg)}}}function M(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;var s=h(n,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,v;var i=s.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(B(e)+" is not iterable")}return g.prototype=_,n(P,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:g,configurable:!0}),g.displayName=c(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,c(t,l,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},x(C.prototype),c(C.prototype,o,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,a,n,s){void 0===s&&(s=Promise);var i=new C(u(t,r,a,n),s);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},x(P),c(P,l,"Generator"),c(P,i,(function(){return this})),c(P,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=D,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return o.type="throw",o.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var i=this.tryEntries[s],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var i=s?s.completion:{};return i.type=t,i.arg=e,s?(this.method="next",this.next=s.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:D(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function Y(t,e,r,a,n,s,i){try{var o=t[s](i),l=o.value}catch(t){return void r(t)}o.done?e(l):Promise.resolve(l).then(a,n)}function J(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function i(t){Y(s,a,n,i,o,"next",t)}function o(t){Y(s,a,n,i,o,"throw",t)}i(void 0)}))}}const V={components:{AppTimePicker:l,AppRefreshPicker:h,DashboardPanel:f,StatPanel:y,ChartPanel:C,RecentMessagesPanel:k,MessageDetails:T},mixins:[n],data:function(){return{timePreset:"-1 hours",refresh:!1,refreshTimer:null,refreshDelay:1e4,init:!1,summary:{},chartSeries:[],chartOptions:{colors:["#909399","#E6A23C","#67C23A","#F56C6C"],yaxis:{forceNiceScale:!0,min:0}},recentMessages:{data:[],total:0,pageSize:10,page:1,search:""},drawer:!1,drawerMessage:null}},computed:{hasConsumers:function(){return this.summary.consumers&&Number(this.summary.consumers)>0}},watch:{refresh:function(t){localStorage["bsi.queue.dashboard.refresh"]=t,this.initAutoUpdate()}},created:function(){var t=this,e=localStorage.getItem("bsi.queue.dashboard.timePreset");e&&(this.timePreset=e),"true"===localStorage.getItem("bsi.queue.dashboard.refresh")&&(this.refresh=!0),this.fetchData().then((function(){t.init=!0}))},beforeDestroy:function(){clearInterval(this.refreshTimer)},methods:{fetchData:function(){return Promise.all([this.fetchSummaryData(),this.fetchChartData(),this.fetchRecentMessagesData()])},fetchSummaryData:function(){var t=this;return J(H().mark((function e(){return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U("bsi:queue.api.dashboard.summary",{from:t.timePreset,to:"now"});case 2:t.summary=e.sent;case 3:case"end":return e.stop()}}),e)})))()},fetchChartData:function(){var t=this;return J(H().mark((function e(){var r;return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U("bsi:queue.api.dashboard.queryRange",{from:t.timePreset,to:"now"});case 2:r=e.sent,t.chartSeries=r.map((function(e){return{name:t.$t("enums.status.".concat(e.status)),data:e.values.map((function(t){return t[0]*=1e3,t}))}}));case 4:case"end":return e.stop()}}),e)})))()},fetchRecentMessagesData:function(){var t=this;return J(H().mark((function e(){var r;return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U("bsi:queue.api.dashboard.recentMessages",{from:t.timePreset,to:"now",pageSize:t.recentMessages.pageSize,page:t.recentMessages.page,search:t.recentMessages.search});case 2:r=e.sent,t.recentMessages.data=r.data,t.recentMessages.total=r.total;case 5:case"end":return e.stop()}}),e)})))()},initAutoUpdate:function(){!0===this.refresh?this.refreshTimer=setInterval(this.autoUpdate,this.refreshDelay):clearInterval(this.refreshTimer)},autoUpdate:function(){this.fetchData()},handleTimePresetChange:function(t){localStorage["bsi.queue.dashboard.timePreset"]=t,this.fetchData()},handleMessageSelect:function(t){this.drawerMessage=t,this.drawer=!0},handleRecentMessagesPaginate:function(t){this.recentMessages.page=t,this.fetchRecentMessagesData()},handleRecentMessagesPageSizeChange:function(t){this.recentMessages.pageSize=t,this.recentMessages.page=1,this.fetchRecentMessagesData()},handleRecentMessagesSearch:function(t){this.recentMessages.search=t,this.recentMessages.page=1,this.fetchRecentMessagesData()},handleDrawerClosed:function(){this.drawerMessage=null}}};const X=(0,o.Z)(V,a,[],!1,null,null,null).exports},4654:()=>{}}]);